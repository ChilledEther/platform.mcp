{
  "name": "new_azure_firewall_rules",
  "description": "Adds a new Azure firewall whitelist rule and returns updated YAML content.\n\nIMPORTANT - Content-Return Pattern:\nThis tool does NOT write files directly. You (the agent) MUST:\n1. FIRST, determine the repository root. If working in a multi-repo workspace, ASK the user which repository to use.\n2. Read the existing 'azure-firewall-rules.yaml' file from the repository root (if it exists).\n3. Pass the file content as the 'existing_yaml' parameter (or empty string if file doesn't exist).\n4. After receiving the response, write the 'yaml_content' from the response to 'azure-firewall-rules.yaml' at the repository root.\n\nNEVER guess or infer data from the project structure. If the user's request is missing required parameters (team, source, destination), you MUST ASK the user for clarification.\n\nUse the 'Azure Firewall Rule Schema' resource (mcp://azure-firewall/schema) for the expected YAML format.",
  "inputSchema": {
    "type": "object",
    "properties": {
      "team": {
        "type": "string",
        "minLength": 1,
        "description": "The name of the team requesting the rule."
      },
      "source": {
        "type": "string",
        "description": "The source IP address or CIDR block.",
        "pattern": "^(([0-9]|[1-9][0-9]|1[0-9]{2}|2[0-4][0-9]|25[0-5])\\.){3}([0-9]|[1-9][0-9]|1[0-9]{2}|2[0-4][0-9]|25[0-5])(\\/([0-9]|[1-2][0-9]|3[0-2]))?$"
      },
      "destination": {
        "type": "string",
        "description": "The destination IP address or CIDR block.",
        "pattern": "^(([0-9]|[1-9][0-9]|1[0-9]{2}|2[0-4][0-9]|25[0-5])\\.){3}([0-9]|[1-9][0-9]|1[0-9]{2}|2[0-4][0-9]|25[0-5])(\\/([0-9]|[1-2][0-9]|3[0-2]))?$"
      },
      "port": {
        "type": "integer",
        "description": "The destination port (defaults to 443).",
        "default": 443,
        "minimum": 1,
        "maximum": 65535
      },
      "existing_yaml": {
        "type": "string",
        "description": "Current content of azure-firewall-rules.yaml. Pass empty string if file does not exist. The agent MUST read this file from the repository root before calling this tool.",
        "default": ""
      }
    },
    "required": [
      "team",
      "source",
      "destination"
    ]
  },
  "responseSchema": {
    "type": "object",
    "properties": {
      "yaml_content": {
        "type": "string",
        "description": "The full YAML content to write to azure-firewall-rules.yaml"
      },
      "filename": {
        "type": "string",
        "description": "Always 'azure-firewall-rules.yaml'"
      },
      "action": {
        "type": "string",
        "enum": ["created", "updated", "duplicate_detected"],
        "description": "The action taken by the tool"
      },
      "message": {
        "type": "string",
        "description": "Human-readable status message"
      }
    },
    "required": ["yaml_content", "filename", "action", "message"]
  }
}
